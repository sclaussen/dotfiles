#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Package Manager Configuration (Homebrew for macOS)
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
export HOMEBREW_PREFIX="/opt/homebrew"
export HOMEBREW_CELLAR="/opt/homebrew/Cellar"
export HOMEBREW_REPOSITORY="/opt/homebrew"
export PATH="$HOMEBREW_PREFIX/bin:$HOMEBREW_PREFIX/sbin:$PATH"                      # Add Homebrew binaries to PATH
export MANPATH=$MANPATH:/opt/homebrew/share/man                                     # Add Homebrew man pages to respective paths
export INFOPATH=$INFOPATH:/opt/homebrew/share/info                                  # Add Homebrew info pages to respective paths

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# macOS-specific PATH additions
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
export PATH="$HOME/.rd/bin:$PATH"                                                    # Add Rancher Desktop bin directory to PATH
export PATH="$HOME/Library/Python/3.9/bin:$PATH"                                     # Add Python 3.9 user binaries to PATH
export PATH="/Library/TeX/texbin:$PATH"                                              # Add TeX distribution binaries to PATH

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# macOS-specific aliases and functions
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
alias o='open .'                                                                   # Open current directory in Finder

# iTerm2 tab opening with Claude Code
alias srcc='oiterm src ~/src "dev ccc"'
alias devrc='oiterm devr ~/src/dev "dev ccc"'
alias devc='oiterm dev ~/src/dev/dev "dev ccc"'
alias ahac='oiterm aha ~/src/dev/aha "dev ccc"'
alias mdc='oiterm md ~/src/dev/md "dev ccc"'
alias toolsc='oiterm tools ~/src/dev/tools "dev ccc"'
alias appc='oiterm app ~/src/app "dev ccc"'
alias playbackc='oiterm playback ~/src/app/playback "dev ccc"'
alias planc='oiterm plan ~/src/app/plan "dev ccc"'
alias interappc='oiterm interapp ~/src/app/appconsole/interapp "dev ccc"'
alias appmgrc='oiterm appmgr ~/src/app/appmgr "dev ccc"'
alias odinc='oiterm odin ~/src/odin "dev ccc"'
alias dotc='oiterm dotfiles "~/src/dotfiles" "dev ccc"'
alias aicodingc='oiterm aicoding ~/src/aicoding "dev ccc"'
alias aidevc='oiterm aidev ~/src/aidev "dev ccc"'

# iTerm2 tab opening for shell only
alias srcz='oiterm "~/src" ~/src'
alias devrz='oiterm "~/src/dev" ~/src/dev'
alias devz='oiterm "~/src/dev/dev" ~/src/dev/dev'
alias ahaz='oiterm "~/src/dev/aha" ~/src/dev/aha'
alias mdz='oiterm "~/src/dev/md" ~/src/dev/md'
alias toolsz='oiterm "~/src/dev/tools" ~/src/dev/tools'
alias appz='oiterm "~/src/app" ~/src/app'
alias playbackz='oiterm "~/src/app/playback" ~/src/app/playback'
alias planz='oiterm "~/src/app/plan" ~/src/app/plan'
alias interappz='oiterm "~/src/.../interapp" ~/src/app/appconsole/interapp'
alias appmgrz='oiterm "~/src/app/appmgr" ~/src/app/appmgr'
alias odinz='oiterm "~/src/odin" ~/src/odin'
alias dotz='oiterm "~/src/dotfiles" ~/src/dotfiles'
alias aicodingz='oiterm "~/src/aicoding" ~/src/aicoding'
alias aidevz='oiterm "~/src/aidev" ~/src/aidev'

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# macOS ls configuration
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# macOS-specific ls configuration
auto=$(defaults read -g AppleInterfaceStyleSwitchesAutomatically 2>/dev/null)
mode=$(defaults read -g AppleInterfaceStyle 2>/dev/null)
if { [[ "$auto" == "1" && -z "$mode" ]] || [[ "$mode" == "Dark" ]]; }; then
  export LSCOLORS="GxBxxxxxCxxxxxxxxxGxGx"
else
  export LSCOLORS="ExFxBxDxCxegedabagacad"
fi

# macOS ls aliases
alias l="ls -1FG"                                                                  # List files with indicators
alias la='ls -1AFG'                                                                # List all files with indicators
alias ll='ls -FGlAhp'                                                              # Detailed list view
alias ls="command ls -G"                                                           # Enable colored ls
alias lsa="command ls -aG"                                                         # List all with colors
alias lsd="ls -lFG | grep --color=never '^d'"                                      # List directories only


# macOS Emacs client alias
alias e='/Applications/Emacs.app/Contents/MacOS/bin-arm64-11/emacsclient'          # Emacs client

# macOS Spotlight search function
spot() { mdfind "kMDItemDisplayName == '*$@*'"; }                                  # Search Spotlight for a specific item

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# macOS-specific editor configuration
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
export EDITOR='/Applications/Emacs.app/Contents/MacOS/bin-arm64-11/emacsclient'  # Set the default editor to Emacs client for command-line editing tasks.
export VISUAL='/Applications/Emacs.app/Contents/MacOS/bin-arm64-11/emacsclient'  # Set the default visual editor to Emacs client. This is used by programs that require a visual editor, like `git commit`.

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# macOS-specific aliases
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
alias tag="find . -type f | grep -v node_modules | grep -v .venv | grep -v '/.#' | grep -v .git | /Applications/Emacs.app/Contents/MacOS/bin/etags -"  # Generate tags excluding certain directories
alias tagall="find . -type f | grep -v .git | grep -v node_modules | grep -v .venv | grep -v '/.#' | /Applications/Emacs.app/Contents/MacOS/bin/etags -"  # Generate all tags excluding certain directories

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Additional macOS configuration (Claude Code and API keys)
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Claude Code
# export CLAUDE_CODE_SHELL_PREFIX="zsh -ic"
alias tasks="node ~/src/sync/tasks.js"
alias dcc="dev cc"
alias md="~/src/dev/md/md.js"

# API AI Keys
if [ -f ~/.env ]; then . ~/.env; fi

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# macOS History Configuration
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
export HISTFILE=~/.zsh_history

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Alias for tools
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
unhibdemo() {
  node ~/src/dev/tools/unhib/unhib.js -p dev.xapps.claimsdev.demodev -p dev.xapps.claimsdev.demoqa
}

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Source cross-platform configuration
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[[ -f ~/.zshrc.local ]] && source ~/.zshrc.local
