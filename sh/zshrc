#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Package Manager Configuration (Homebrew for macOS)
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
export HOMEBREW_PREFIX="/opt/homebrew"
export HOMEBREW_CELLAR="/opt/homebrew/Cellar"
export HOMEBREW_REPOSITORY="/opt/homebrew"
export PATH="$HOMEBREW_PREFIX/bin:$HOMEBREW_PREFIX/sbin:$PATH"                      # Add Homebrew binaries to PATH
export MANPATH=$MANPATH:/opt/homebrew/share/man                                     # Add Homebrew man pages to respective paths
export INFOPATH=$INFOPATH:/opt/homebrew/share/info                                  # Add Homebrew info pages to respective paths

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# macOS-specific PATH additions
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
export PATH="$HOME/.rd/bin:$PATH"                                                    # Add Rancher Desktop bin directory to PATH
export PATH="$HOME/Library/Python/3.9/bin:$PATH"                                     # Add Python 3.9 user binaries to PATH

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# macOS-specific aliases and functions
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
alias o='open .'                                                                   # Open current directory in Finder

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# macOS ls configuration
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# macOS-specific ls configuration
auto=$(defaults read -g AppleInterfaceStyleSwitchesAutomatically 2>/dev/null)
mode=$(defaults read -g AppleInterfaceStyle 2>/dev/null)
if { [[ "$auto" == "1" && -z "$mode" ]] || [[ "$mode" == "Dark" ]]; }; then
  export LSCOLORS="GxBxxxxxCxxxxxxxxxGxGx"
else
  export LSCOLORS="ExFxBxDxCxegedabagacad"
fi

# macOS ls aliases
alias l="ls -1FG"                                                                  # List files with indicators
alias la='ls -1AFG'                                                                # List all files with indicators
alias ll='ls -FGlAhp'                                                              # Detailed list view
alias ls="command ls -G"                                                           # Enable colored ls
alias lsa="command ls -aG"                                                         # List all with colors
alias lsd="ls -lFG | grep --color=never '^d'"                                      # List directories only


# macOS Emacs client alias
alias e='/Applications/Emacs.app/Contents/MacOS/bin-arm64-11/emacsclient'          # Emacs client

# macOS Spotlight search function
spot() { mdfind "kMDItemDisplayName == '*$@*'"; }                                  # Search Spotlight for a specific item

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# macOS-specific editor configuration
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
export EDITOR='/Applications/Emacs.app/Contents/MacOS/bin-arm64-11/emacsclient'  # Set the default editor to Emacs client for command-line editing tasks.
export VISUAL='/Applications/Emacs.app/Contents/MacOS/bin-arm64-11/emacsclient'  # Set the default visual editor to Emacs client. This is used by programs that require a visual editor, like `git commit`.

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# macOS-specific aliases
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
alias tag="find . -type f | grep -v node_modules | grep -v .venv | grep -v '/.#' | grep -v .git | /Applications/Emacs.app/Contents/MacOS/bin/etags -"  # Generate tags excluding certain directories
alias tagall="find . -type f | grep -v .git | grep -v node_modules | grep -v .venv | grep -v '/.#' | /Applications/Emacs.app/Contents/MacOS/bin/etags -"  # Generate all tags excluding certain directories

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Additional macOS configuration (Claude Code and API keys)
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Claude Code
# export CLAUDE_CODE_SHELL_PREFIX="zsh -ic"
alias tasks="node ~/src/sync/tasks.js"

# API AI Keys
if [ -f '~/.env' ]; then . ~/.env; fi

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# macOS History Configuration
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
export HISTFILE=~/.zsh_history

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Source cross-platform configuration
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[[ -f ~/.zshrc.local ]] && source ~/.zshrc.local
